<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2196F3">
    <title>Basketball Stat Tracker</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="apple-touch-icon" href="img/icons/icon-192x192.png">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="app-nav">
            <div class="nav-menu" id="nav-menu">
                <button data-screen="setup" class="nav-btn active">Setup</button>
                <button data-screen="game" class="nav-btn">Game Tracker</button>
                <button data-screen="boxscore" class="nav-btn">Box Score</button>
                <button data-screen="dashboard" class="nav-btn">Dashboard</button>
                <button data-screen="teams" class="nav-btn">Teams</button>
            </div>
        </nav>

        <!-- Screens -->
        <main id="screen-container">
            <!-- Game Setup Screen -->
            <section id="setup-screen" class="screen active">
                <h2>Game Setup</h2>
                <div class="setup-container">
                    <!-- Home Team Setup -->
                    <div class="team-setup">
                        <h3>Home Team</h3>
                        <div class="input-group">
                            <label for="home-team">Team Name:</label>
                            <input type="text" id="home-team" placeholder="Home Team">
                        </div>
                        <div class="input-group">
                            <label>Team Selection:</label>
                            <select id="home-team-select">
                                <option value="">-- Select Saved Team --</option>
                            </select>
                        </div>
                        <h4>Players</h4>
                        <div id="home-players" class="player-list">
                            <!-- Player entries will be added dynamically -->
                            <div class="player-entry">
                                <input type="number" placeholder="#" class="player-number">
                                <input type="text" placeholder="Player Name" class="player-name">
                            </div>
                        </div>
                        <button id="add-home-player" class="btn-secondary">+ Add Player</button>
                        <div class="input-group">
                            <label for="home-team-color">Team Color:</label>
                            <select id="home-team-color" class="color-dropdown">
                                <option value="#0A254E" style="background-color: #0A254E; color: white;">Navy Blue</option>
                                <option value="#B72025" style="background-color: #B72025; color: white;">Red</option>
                                <option value="#006B3C" style="background-color: #006B3C; color: white;">Green</option>
                                <option value="#552583" style="background-color: #552583; color: white;">Purple</option>
                                <option value="#CE1141" style="background-color: #CE1141; color: white;">Crimson</option>
                                <option value="#000000" style="background-color: #000000; color: white;">Black</option>
                                <option value="#F58426" style="background-color: #F58426; color: black;">Orange</option>
                                <option value="#FDBB30" style="background-color: #FDBB30; color: black;">Yellow</option>
                                <option value="#5D76A9" style="background-color: #5D76A9; color: white;">Light Blue</option>
                                <option value="#1D1160" style="background-color: #1D1160; color: white;">Dark Purple</option>
                            </select>
                        </div>
                    </div>

                    <!-- Away Team Setup -->
                    <div class="team-setup">
                        <h3>Away Team</h3>
                        <div class="input-group">
                            <label for="away-team">Team Name:</label>
                            <input type="text" id="away-team" placeholder="Away Team">
                        </div>
                        <div class="input-group">
                            <label>Team Selection:</label>
                            <select id="away-team-select">
                                <option value="">-- Select Saved Team --</option>
                            </select>
                        </div>
                        <h4>Players</h4>
                        <div id="away-players" class="player-list">
                            <!-- Player entries will be added dynamically -->
                            <div class="player-entry">
                                <input type="number" placeholder="#" class="player-number">
                                <input type="text" placeholder="Player Name" class="player-name">
                            </div>
                        </div>
                        <button id="add-away-player" class="btn-secondary">+ Add Player</button>
                        <!-- For Away Team -->
                        <div class="input-group">
                            <label for="away-team-color">Team Color:</label>
                            <select id="away-team-color" class="color-dropdown">
                                <option value="#75ACD8" style="background-color: #75ACD8; color: black;">Light Blue</option>
                                <option value="#B72025" style="background-color: #B72025; color: white;">Red</option>
                                <option value="#006B3C" style="background-color: #006B3C; color: white;">Green</option>
                                <option value="#552583" style="background-color: #552583; color: white;">Purple</option>
                                <option value="#CE1141" style="background-color: #CE1141; color: white;">Crimson</option>
                                <option value="#000000" style="background-color: #000000; color: white;">Black</option>
                                <option value="#F58426" style="background-color: #F58426; color: black;">Orange</option>
                                <option value="#FDBB30" style="background-color: #FDBB30; color: black;">Yellow</option>
                                <option value="#0A254E" style="background-color: #0A254E; color: white;">Navy Blue</option>
                                <option value="#1D1160" style="background-color: #1D1160; color: white;">Dark Purple</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="game-meta">
                    <h3>Game Details</h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label for="game-date">Date:</label>
                            <input type="date" id="game-date">
                        </div>
                        <div class="input-group">
                            <label for="game-location">Location:</label>
                            <input type="text" id="game-location" placeholder="Location">
                        </div>
                    </div>
                </div>
                <div class="button-row">
                    <button id="save-teams" class="btn-secondary">Save Teams</button>
                    <button id="start-game" class="btn-primary">Start Game</button>
                </div>
            </section>

            <!-- Game Tracking Screen - Simplified Version -->
            <section id="game-screen" class="screen">
                <div class="score-header">
                    <div class="team home-team">
                        <span class="team-score" id="home-score">0</span>
                        <span class="team-name" id="game-home-team">Home</span>
                    </div>
                    <div class="game-status">
                        <span id="game-period">1st Half</span>
                    </div>
                    <div class="team away-team">
                        <span class="team-score" id="away-score">0</span>
                        <span class="team-name" id="game-away-team">Away</span>
                    </div>
                </div>

                <div class="game-container">
                    <!-- Left Side: Players and Game Log -->
                    <div class="left-panel">
                        <div class="players-section">
                            <div class="home-players-container">
                                <h3>Home Team</h3>
                                <div class="player-selection" id="home-active-players">
                                    <!-- Home players will be populated here -->
                                </div>
                            </div>
                            
                            <div class="away-players-container">
                                <h3>Away Team</h3>
                                <div class="player-selection" id="away-active-players">
                                    <!-- Away players will be populated here -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Game Log -->
                        <div class="action-log">
                            <h3>Game Log</h3>
                            <div id="log-entries" class="log-container">
                                <!-- Log entries will be added here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Side: Action Buttons (Simplified) -->
                    <div class="right-panel">
                        <div id="stat-buttons-container" class="stat-buttons-container">
                            <div id="player-selected-indicator" class="player-selected-indicator" style="display: block; background-color: #ececec; color: black;">No player selected</div>
                            <div class="stat-buttons">
                                <div class="button-group">
                                    <button class="stat-btn" data-stat="fgm">MADE 2</button>
                                    <button class="stat-btn" data-stat="3pm">MADE 3</button>
                                    <button class="stat-btn" data-stat="ftm">MADE FT</button>
                                </div>
                                <div class="button-group">
                                    <button class="stat-btn" data-stat="fga">MISSED 2</button>
                                    <button class="stat-btn" data-stat="3pa">MISSED 3</button>
                                    <button class="stat-btn" data-stat="fta">MISSED FT</button>
                                </div>
                                <div class="button-group">
                                    <button class="stat-btn" data-stat="oreb">O-BOARD</button>
                                    <button class="stat-btn" data-stat="dreb">D-BOARD</button>
                                    <button class="stat-btn" data-stat="ast">ASSIST</button>
                                </div>
                                <div class="button-group">
                                    <button class="stat-btn" data-stat="stl">STEAL</button>
                                    <button class="stat-btn" data-stat="blk">BLOCK</button>
                                    <button class="stat-btn" data-stat="tov">TURNOVER</button>
                                    <button class="stat-btn" data-stat="pf">FOUL</button>
                                </div>
                                <div class="button-group special">
                                    <button class="stat-btn" data-stat="paint">PAINT TOUCH</button>
                                    <button class="stat-btn" data-stat="endPossession">END POSS</button>
                                    <button class="stat-btn" data-stat="undo">UNDO</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="game-controls">
                            <button id="end-period" class="btn-secondary">End Period</button>
                            <button id="end-game" class="btn-primary">End Game</button>
                        </div>
                    </div>
                </div>

                <!-- Hidden elements for player selection state (for JS) -->
                <div style="display: none;">
                    <span id="home-selected-player">None</span>
                    <span id="away-selected-player">None</span>
                </div>
            </section>

            <!-- Box Score Screen -->
            <section id="boxscore-screen" class="screen">
                <h2>Box Score</h2>
                
                <div class="box-score-controls">
                    <div class="team-toggle">
                        <button class="toggle-btn active" data-team="home">Home</button>
                        <button class="toggle-btn" data-team="away">Away</button>
                    </div>
                </div>
                
                <div class="box-score-container">
                    <table id="box-score-table" class="stats-table">
                        <thead>
                            <tr>
                                <th class="player-col">Player</th>
                                <th>PTS</th>
                                <th>FG</th>
                                <th>3PT</th>
                                <th>FT</th>
                                <th>OREB</th>
                                <th>DREB</th>
                                <th>REB</th>
                                <th>AST</th>
                                <th>STL</th>
                                <th>BLK</th>
                                <th>TO</th>
                                <th>PF</th>
                            </tr>
                        </thead>
                        <tbody id="box-score-body">
                            <!-- Box score data will be inserted here -->
                        </tbody>
                        <tfoot id="box-score-totals">
                            <!-- Team totals will go here -->
                        </tfoot>
                    </table>
                </div>
            </section>

            <!-- Dashboard Screen -->
            <section id="dashboard-screen" class="screen">
                <h2>Statistics Dashboard</h2>
                
                <div class="dashboard-container">
                    <div class="dashboard-section team-comparison">
                        <h3>Team Comparison</h3>
                        <div class="stat-comparison">
                            <div class="team-stat" id="home-team-stats">
                                <!-- Home team stats summary -->
                            </div>
                            <div class="team-stat" id="away-team-stats">
                                <!-- Away team stats summary -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-section advanced-stats">
                        <h3>Advanced Statistics</h3>
                        <div class="advanced-container" id="advanced-stats-container">
                            <!-- Advanced stats will go here -->
                        </div>
                    </div>

                    <!-- Possession Statistics Section -->
                    <div class="dashboard-section possession-stats">
                        <h3>Possession Statistics</h3>
                        <div class="possession-summary">
                            <div class="stat-item">
                                <div class="stat-value" id="total-possessions">0</div>
                                <div class="stat-label">Total Possessions</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="home-possessions">0</div>
                                <div class="stat-label">Home Team Possessions</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="away-possessions">0</div>
                                <div class="stat-label">Away Team Possessions</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="avg-possession-time">0</div>
                                <div class="stat-label">Avg Possession Length (sec)</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Shot Chart Section -->
                    <div class="dashboard-section shot-charts">
                        <h3>Shot Charts</h3>
                        <div class="team-toggle">
                            <button class="toggle-btn active" data-team="home">Home</button>
                            <button class="toggle-btn" data-team="away">Away</button>
                            <button class="toggle-btn" data-team="all">All</button>
                        </div>
                        <div class="shot-chart-filter">
                            <button class="filter-btn active" data-filter="all">All Shots</button>
                            <button class="filter-btn" data-filter="makes">Makes</button>
                            <button class="filter-btn" data-filter="misses">Misses</button>
                        </div>
                        <div class="shot-chart-container" id="shot-chart">
                            <!-- Shot chart will be rendered here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Teams Management Screen -->
            <section id="teams-screen" class="screen">
                <h2>Teams Management</h2>
                
                <div class="teams-container">
                    <div class="saved-teams" id="saved-teams-list">
                        <!-- Saved teams will be listed here -->
                    </div>
                    
                    <div class="team-actions">
                        <button id="export-data" class="btn-secondary">Export All Data</button>
                        <button id="import-data" class="btn-secondary">Import Data</button>
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- JavaScript Files -->
    <script src="js/db.js"></script>
    <script src="js/stats.js"></script>
    <script src="js/game.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed:', err));
        }
    </script>
</body>
</html>